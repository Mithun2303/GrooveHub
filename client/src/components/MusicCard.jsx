import Queue from "../assets/queue.png";
import { useRef, useState } from "react"
import play from "../assets/play.svg"
export const MusicCard = ({ queuePointer, onNext, onPrevious, queue, shufflePlay,setShowQueue }) => {
    const [isPlaying, setIsPlaying] = useState(true);
    const [currentTime, setCurrentTime] = useState(0);
    const audioRef = useRef(null);
    const [onRepeat, setOnRepeat] = useState(false);
    const [shuffle,setShuffle] = useState(false);
    const togglePlay = () => {
        if (isPlaying) {
            audioRef.current.pause();
        } else {
            audioRef.current.play();
        }
        setIsPlaying(!isPlaying);
    }

    const handleSeek = (e) => {
        const newTime = parseFloat(e.target.value);
        setCurrentTime(newTime);
        audioRef.current.currentTime = newTime;
    };
    const handleTimeUpdate = () => {
        setCurrentTime(audioRef.current.currentTime);
    };

    return queue[queuePointer] != null ?
        <main className="w-full h-auto bg-primary rounded-2xl flex flex-col">
            <div className={`h-[300px] m-4 flex justify-between flex-col-reverse bg-cover bg-center `} style={{ backgroundImage: `url(${queue[queuePointer].album.cover})` }}>
                <div className=" backdrop-blur-xl flex flex-col text-white p-4">
                    <span className="text-md font-semibold w-full truncate">
                        {queue[queuePointer].title}
                    </span>
                    <span className="text-sm font-extralight w-full truncate">
                        {queue[queuePointer].artists[0].name}
                    </span>
                </div>
                <button onClick={(e)=>{
                    e.preventDefault();
                    setShowQueue(true);
                }} className="bg-blend-overlay p-2 flex flex-row-reverse">
                    <img src={Queue} className="bg-black drop-shadow-lg" alt="" />
                </button>
            </div>
            {/* <hr className="border-2 rounded-2xl mx-4" /> */}
            <input
                type="range"
                id="range3"
                value={currentTime}
                min="0"
                max={audioRef.current?.duration || 0}
                step="0.1"
                onChange={(e) => handleSeek(e)}
                className="mx-4"
            />
            <audio src={queue[queuePointer].link} ref={audioRef} onTimeUpdate={handleTimeUpdate} autoPlay onEnded={onNext} ></audio>
            <div className="controls flex justify-evenly items-center mt-1">
                <button onClick={(e) => {
                    e.preventDefault();
                    setShuffle(!shuffle);
                }
                }>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.50399 15.7C7.33199 16.79 5.90999 17.573 3.99099 17.55C3.79208 17.5476 3.60226 17.4663 3.4633 17.324C3.32433 17.1816 3.24761 16.9899 3.24999 16.791C3.25238 16.5921 3.33369 16.4023 3.47603 16.2633C3.61837 16.1243 3.81008 16.0476 4.00899 16.05C5.44399 16.068 6.51099 15.505 7.48199 14.601C8.25999 13.877 8.93299 12.981 9.66899 12.001C9.88899 11.707 10.116 11.405 10.353 11.098C11.347 9.80999 12.492 8.47799 14.043 7.58399C15.62 6.67499 17.558 6.25099 20.08 6.65999C20.1795 6.67309 20.2754 6.70604 20.3619 6.75688C20.4485 6.80772 20.5239 6.87541 20.5838 6.95595C20.6437 7.03648 20.6869 7.12822 20.7107 7.22573C20.7345 7.32325 20.7385 7.42454 20.7224 7.52362C20.7063 7.6227 20.6705 7.71755 20.6171 7.80254C20.5637 7.88753 20.4938 7.96094 20.4115 8.01842C20.3293 8.0759 20.2363 8.11628 20.1381 8.13716C20.0399 8.15804 19.9385 8.159 19.84 8.13999C17.63 7.78299 16.046 8.16099 14.791 8.88399C13.511 9.62199 12.515 10.751 11.541 12.014C11.336 12.28 11.13 12.554 10.921 12.832C10.171 13.832 9.38999 14.876 8.50399 15.7Z" fill={`${shuffle?'black':'white'}`} />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M16.04 3.46899C16.1807 3.32868 16.3714 3.24997 16.5702 3.25015C16.7689 3.25034 16.9595 3.32941 17.1 3.46999L20.531 6.90999C20.6714 7.05062 20.7503 7.24124 20.7503 7.43999C20.7503 7.63874 20.6714 7.82937 20.531 7.96999L17.099 11.41C16.9584 11.5508 16.7677 11.63 16.5687 11.6302C16.3697 11.6304 16.1788 11.5516 16.038 11.411C15.8972 11.2704 15.8179 11.0797 15.8177 10.8807C15.8176 10.6817 15.8964 10.4908 16.037 10.35L18.941 7.43999L16.038 4.52999C15.9684 4.46028 15.9132 4.37752 15.8755 4.28646C15.8379 4.1954 15.8186 4.09782 15.8186 3.99929C15.8187 3.90075 15.8383 3.80321 15.8761 3.71222C15.9139 3.62123 15.9692 3.53858 16.039 3.46899M16.055 12.654C16.1998 12.5177 16.3928 12.4445 16.5916 12.4505C16.7904 12.4565 16.9787 12.5412 17.115 12.686L20.505 16.286C20.6415 16.4306 20.7151 16.6234 20.7095 16.8222C20.7038 17.021 20.6195 17.2094 20.475 17.346L17.084 20.546C16.9393 20.6826 16.7463 20.7561 16.5474 20.7504C16.3485 20.7447 16.1601 20.6602 16.0235 20.5155C15.8869 20.3708 15.8134 20.1778 15.8191 19.9789C15.8248 19.78 15.9093 19.5916 16.054 19.455L18.9 16.769L16.023 13.714C15.8867 13.5692 15.8135 13.3761 15.8195 13.1774C15.8255 12.9786 15.9102 12.7903 16.055 12.654Z" fill={`${shuffle?'black':'white'}`} />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.53 9.39598C6.574 8.48998 5.496 7.92298 4.014 7.94998C3.91551 7.95169 3.81764 7.93398 3.726 7.89787C3.63435 7.86175 3.55071 7.80794 3.47986 7.7395C3.33677 7.60129 3.25445 7.41189 3.251 7.21298C3.24929 7.11449 3.267 7.01663 3.30311 6.92498C3.33923 6.83333 3.39304 6.74969 3.46148 6.67884C3.59969 6.53575 3.78909 6.45343 3.988 6.44998C5.95 6.41498 7.391 7.19798 8.563 8.30598C9.484 9.17798 10.273 10.289 11.023 11.346C11.193 11.586 11.362 11.823 11.529 12.055C12.465 13.345 13.405 14.496 14.623 15.255C15.81 15.995 17.315 16.395 19.445 16.059C19.6415 16.0281 19.8423 16.0765 20.0031 16.1936C20.1639 16.3108 20.2716 16.487 20.3025 16.6835C20.3334 16.88 20.285 17.0808 20.1678 17.2416C20.0507 17.4024 19.8745 17.5101 19.678 17.541C17.219 17.928 15.345 17.473 13.83 16.528C12.345 15.603 11.261 14.241 10.315 12.935C10.125 12.673 9.941 12.415 9.762 12.162C9.017 11.114 8.336 10.156 7.532 9.39598" fill={`${shuffle?'black':'white'}`} />
                    </svg>
                </button>
                <button onClick={(e) => {
                    e.preventDefault();
                    if (queue.length == 1) {
                        audioRef.currentTime = 0;
                        console.log(queue);
                    }
                    else {
                        console.log(queue);
                        onPrevious();
                    }
                }}>
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8.75 35C9.08152 35 9.39946 34.8683 9.63388 34.6339C9.86831 34.3995 10 34.0815 10 33.75L10 23.0914L28.1852 33.9758C28.6052 34.2313 29.0861 34.3693 29.5777 34.3753C30.0693 34.3814 30.5535 34.2552 30.9797 34.0102C31.9172 33.4789 32.5 32.4508 32.5 31.3281L32.5 8.67188C32.5 7.54922 31.9172 6.5211 30.9797 5.98985C30.5534 5.74495 30.0692 5.61902 29.5776 5.62521C29.086 5.63139 28.6051 5.76946 28.1852 6.025L10 16.9086V6.25C10 5.91848 9.86831 5.60054 9.63388 5.36612C9.39946 5.13169 9.08152 5 8.75 5C8.41848 5 8.10054 5.13169 7.86612 5.36612C7.63169 5.60054 7.5 5.91848 7.5 6.25L7.5 33.75C7.5 34.0815 7.63169 34.3995 7.86612 34.6339C8.10054 34.8683 8.41848 35 8.75 35Z" fill="white" />
                    </svg>
                </button>
                <button onClick={(e) => { e.preventDefault(); togglePlay() }}>
                    {
                        isPlaying ?
                            <svg width="60" height="60" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M18.3333 11.6667H13.3333V28.3333H18.3333V11.6667ZM21.6666 28.3333H26.6666V11.6667H21.6666V28.3333Z" fill="white" />
                            </svg>
                            : <img src={play} alt="" />
                    }
                </button>
                <button
                    onClick={(e) => {
                        console.log(queue);
                        e.preventDefault();
                        if(shuffle){
                            shufflePlay();
                            console.log(queuePointer)
                        }
                        else{
                            onNext();
                        }
                    }}>
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M31.25 5C30.9185 5 30.6005 5.1317 30.3661 5.36612C30.1317 5.60054 30 5.91848 30 6.25V16.9086L11.8148 6.02422C11.3948 5.76872 10.9139 5.63074 10.4223 5.62469C9.93069 5.61864 9.4465 5.74475 9.02031 5.98984C8.08281 6.52109 7.5 7.54922 7.5 8.67188V31.3281C7.5 32.4508 8.08281 33.4789 9.02031 34.0102C9.44659 34.255 9.93081 34.381 10.4224 34.3748C10.914 34.3686 11.3949 34.2305 11.8148 33.975L30 23.0914V33.75C30 34.0815 30.1317 34.3995 30.3661 34.6339C30.6005 34.8683 30.9185 35 31.25 35C31.5815 35 31.8995 34.8683 32.1339 34.6339C32.3683 34.3995 32.5 34.0815 32.5 33.75V6.25C32.5 5.91848 32.3683 5.60054 32.1339 5.36612C31.8995 5.1317 31.5815 5 31.25 5Z" fill="white" />
                    </svg>
                </button>
                <button onClick={(e) => {
                    e.preventDefault();
                    if (onRepeat) {
                        audioRef.current.loop = false;
                        setOnRepeat(false);
                        console.log(audioRef);
                    }
                    else {
                        audioRef.current.loop = true;
                        setOnRepeat(true);
                        console.log(audioRef);
                    }
                }}>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_2_333)">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2.61403 5.426C2.72757 5.15188 2.91985 4.91758 3.16656 4.75276C3.41327 4.58793 3.70332 4.49997 4.00003 4.5H14C15.9892 4.5 17.8968 5.29018 19.3033 6.6967C20.7099 8.10322 21.5 10.0109 21.5 12C21.5 13.9891 20.7099 15.8968 19.3033 17.3033C17.8968 18.7098 15.9892 19.5 14 19.5H5.00003C4.6022 19.5 4.22067 19.342 3.93937 19.0607C3.65806 18.7794 3.50003 18.3978 3.50003 18C3.50003 17.6022 3.65806 17.2206 3.93937 16.9393C4.22067 16.658 4.6022 16.5 5.00003 16.5H14C15.1935 16.5 16.3381 16.0259 17.182 15.182C18.0259 14.3381 18.5 13.1935 18.5 12C18.5 10.8065 18.0259 9.66193 17.182 8.81802C16.3381 7.97411 15.1935 7.5 14 7.5H7.62103L8.56103 8.44C8.83413 8.72303 8.98515 9.10201 8.98155 9.4953C8.97795 9.8886 8.82001 10.2647 8.54177 10.5427C8.26353 10.8207 7.88723 10.9783 7.49393 10.9815C7.10063 10.9847 6.7218 10.8334 6.43903 10.56L2.93903 7.06C2.72941 6.85026 2.58666 6.5831 2.52882 6.29227C2.47097 6.00144 2.50062 5.69999 2.61403 5.426Z" fill={`${onRepeat ? 'black' : 'white'}`} />
                        </g>
                        <defs>
                            <clipPath id="clip0_2_333">
                                <rect width="24" height="24" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                </button>
            </div>
        </main> : <main className="w-full h-auto bg-primary rounded-2xl flex flex-col">
            <div className="h-[300px] m-4 flex flex-col-reverse bg-cover bg-center bg-[url('https://s3-alpha-sig.figma.com/img/b133/f67b/0adf47d043143311aca6ec372cc1f498?Expires=1715558400&Key-Pair-Id=APKAQ4GOSFWCVNEHN3O4&Signature=na~fOWSKehM725la4bLl1XpRqa4MWElVzJEkRD97TDgqkqVIqr1o8t9nLCvC4c0YxInIXllVMZfB-D0EVURSFX-nfsxSEwkLQ3UZWLDCExd-tfZwLBqLWqWI93HjJg7RC~3YORqdJ-LtZmKkqGa1RlzcRAfRLB4WDysK4-Y8M6bSKJGhfGls4QGTexp~ESsvMHwclnnvrflHwACyA~H4SMiRFjerzXVDHPafnJXdGcgCw60bsH54kN5B1Lnrmgh2wHwQUZSjJRiTvk34JBhx2KwvUoovK9gR7e6z3zNA1msjJZm0yWpwb1NMVF9-6tlSYBz1dwO7gPQ0KIB1wpfLcQ__')]">
                <div className=" backdrop-blur-xl flex flex-col text-white p-4">
                    <span className="text-md font-semibold w-full truncate">
                        Hukum
                    </span>
                    <span className="text-sm font-extralight w-full truncate">
                        Anirudh Ravichander
                    </span>
                </div>
            </div>
            <hr className="border-2 rounded-2xl mx-4" />
            <div className="controls flex justify-evenly items-center mt-1">
                <div>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M8.50399 15.7C7.33199 16.79 5.90999 17.573 3.99099 17.55C3.79208 17.5476 3.60226 17.4663 3.4633 17.324C3.32433 17.1816 3.24761 16.9899 3.24999 16.791C3.25238 16.5921 3.33369 16.4023 3.47603 16.2633C3.61837 16.1243 3.81008 16.0476 4.00899 16.05C5.44399 16.068 6.51099 15.505 7.48199 14.601C8.25999 13.877 8.93299 12.981 9.66899 12.001C9.88899 11.707 10.116 11.405 10.353 11.098C11.347 9.80999 12.492 8.47799 14.043 7.58399C15.62 6.67499 17.558 6.25099 20.08 6.65999C20.1795 6.67309 20.2754 6.70604 20.3619 6.75688C20.4485 6.80772 20.5239 6.87541 20.5838 6.95595C20.6437 7.03648 20.6869 7.12822 20.7107 7.22573C20.7345 7.32325 20.7385 7.42454 20.7224 7.52362C20.7063 7.6227 20.6705 7.71755 20.6171 7.80254C20.5637 7.88753 20.4938 7.96094 20.4115 8.01842C20.3293 8.0759 20.2363 8.11628 20.1381 8.13716C20.0399 8.15804 19.9385 8.159 19.84 8.13999C17.63 7.78299 16.046 8.16099 14.791 8.88399C13.511 9.62199 12.515 10.751 11.541 12.014C11.336 12.28 11.13 12.554 10.921 12.832C10.171 13.832 9.38999 14.876 8.50399 15.7Z" fill="white" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M16.04 3.46899C16.1807 3.32868 16.3714 3.24997 16.5702 3.25015C16.7689 3.25034 16.9595 3.32941 17.1 3.46999L20.531 6.90999C20.6714 7.05062 20.7503 7.24124 20.7503 7.43999C20.7503 7.63874 20.6714 7.82937 20.531 7.96999L17.099 11.41C16.9584 11.5508 16.7677 11.63 16.5687 11.6302C16.3697 11.6304 16.1788 11.5516 16.038 11.411C15.8972 11.2704 15.8179 11.0797 15.8177 10.8807C15.8176 10.6817 15.8964 10.4908 16.037 10.35L18.941 7.43999L16.038 4.52999C15.9684 4.46028 15.9132 4.37752 15.8755 4.28646C15.8379 4.1954 15.8186 4.09782 15.8186 3.99929C15.8187 3.90075 15.8383 3.80321 15.8761 3.71222C15.9139 3.62123 15.9692 3.53858 16.039 3.46899M16.055 12.654C16.1998 12.5177 16.3928 12.4445 16.5916 12.4505C16.7904 12.4565 16.9787 12.5412 17.115 12.686L20.505 16.286C20.6415 16.4306 20.7151 16.6234 20.7095 16.8222C20.7038 17.021 20.6195 17.2094 20.475 17.346L17.084 20.546C16.9393 20.6826 16.7463 20.7561 16.5474 20.7504C16.3485 20.7447 16.1601 20.6602 16.0235 20.5155C15.8869 20.3708 15.8134 20.1778 15.8191 19.9789C15.8248 19.78 15.9093 19.5916 16.054 19.455L18.9 16.769L16.023 13.714C15.8867 13.5692 15.8135 13.3761 15.8195 13.1774C15.8255 12.9786 15.9102 12.7903 16.055 12.654Z" fill="white" />
                        <path fill-rule="evenodd" clip-rule="evenodd" d="M7.53 9.39598C6.574 8.48998 5.496 7.92298 4.014 7.94998C3.91551 7.95169 3.81764 7.93398 3.726 7.89787C3.63435 7.86175 3.55071 7.80794 3.47986 7.7395C3.33677 7.60129 3.25445 7.41189 3.251 7.21298C3.24929 7.11449 3.267 7.01663 3.30311 6.92498C3.33923 6.83333 3.39304 6.74969 3.46148 6.67884C3.59969 6.53575 3.78909 6.45343 3.988 6.44998C5.95 6.41498 7.391 7.19798 8.563 8.30598C9.484 9.17798 10.273 10.289 11.023 11.346C11.193 11.586 11.362 11.823 11.529 12.055C12.465 13.345 13.405 14.496 14.623 15.255C15.81 15.995 17.315 16.395 19.445 16.059C19.6415 16.0281 19.8423 16.0765 20.0031 16.1936C20.1639 16.3108 20.2716 16.487 20.3025 16.6835C20.3334 16.88 20.285 17.0808 20.1678 17.2416C20.0507 17.4024 19.8745 17.5101 19.678 17.541C17.219 17.928 15.345 17.473 13.83 16.528C12.345 15.603 11.261 14.241 10.315 12.935C10.125 12.673 9.941 12.415 9.762 12.162C9.017 11.114 8.336 10.156 7.532 9.39598" fill="white" />
                    </svg>
                </div>
                <div>
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M8.75 35C9.08152 35 9.39946 34.8683 9.63388 34.6339C9.86831 34.3995 10 34.0815 10 33.75L10 23.0914L28.1852 33.9758C28.6052 34.2313 29.0861 34.3693 29.5777 34.3753C30.0693 34.3814 30.5535 34.2552 30.9797 34.0102C31.9172 33.4789 32.5 32.4508 32.5 31.3281L32.5 8.67188C32.5 7.54922 31.9172 6.5211 30.9797 5.98985C30.5534 5.74495 30.0692 5.61902 29.5776 5.62521C29.086 5.63139 28.6051 5.76946 28.1852 6.025L10 16.9086V6.25C10 5.91848 9.86831 5.60054 9.63388 5.36612C9.39946 5.13169 9.08152 5 8.75 5C8.41848 5 8.10054 5.13169 7.86612 5.36612C7.63169 5.60054 7.5 5.91848 7.5 6.25L7.5 33.75C7.5 34.0815 7.63169 34.3995 7.86612 34.6339C8.10054 34.8683 8.41848 35 8.75 35Z" fill="white" />
                    </svg>
                </div>
                <div>
                    <svg width="60" height="60" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M18.3333 11.6667H13.3333V28.3333H18.3333V11.6667ZM21.6666 28.3333H26.6666V11.6667H21.6666V28.3333Z" fill="white" />
                    </svg>
                </div>
                <div>
                    <svg width="40" height="40" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M31.25 5C30.9185 5 30.6005 5.1317 30.3661 5.36612C30.1317 5.60054 30 5.91848 30 6.25V16.9086L11.8148 6.02422C11.3948 5.76872 10.9139 5.63074 10.4223 5.62469C9.93069 5.61864 9.4465 5.74475 9.02031 5.98984C8.08281 6.52109 7.5 7.54922 7.5 8.67188V31.3281C7.5 32.4508 8.08281 33.4789 9.02031 34.0102C9.44659 34.255 9.93081 34.381 10.4224 34.3748C10.914 34.3686 11.3949 34.2305 11.8148 33.975L30 23.0914V33.75C30 34.0815 30.1317 34.3995 30.3661 34.6339C30.6005 34.8683 30.9185 35 31.25 35C31.5815 35 31.8995 34.8683 32.1339 34.6339C32.3683 34.3995 32.5 34.0815 32.5 33.75V6.25C32.5 5.91848 32.3683 5.60054 32.1339 5.36612C31.8995 5.1317 31.5815 5 31.25 5Z" fill="white" />
                    </svg>
                </div>
                <button>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <g clip-path="url(#clip0_2_333)">
                            <path fill-rule="evenodd" clip-rule="evenodd" d="M2.61403 5.426C2.72757 5.15188 2.91985 4.91758 3.16656 4.75276C3.41327 4.58793 3.70332 4.49997 4.00003 4.5H14C15.9892 4.5 17.8968 5.29018 19.3033 6.6967C20.7099 8.10322 21.5 10.0109 21.5 12C21.5 13.9891 20.7099 15.8968 19.3033 17.3033C17.8968 18.7098 15.9892 19.5 14 19.5H5.00003C4.6022 19.5 4.22067 19.342 3.93937 19.0607C3.65806 18.7794 3.50003 18.3978 3.50003 18C3.50003 17.6022 3.65806 17.2206 3.93937 16.9393C4.22067 16.658 4.6022 16.5 5.00003 16.5H14C15.1935 16.5 16.3381 16.0259 17.182 15.182C18.0259 14.3381 18.5 13.1935 18.5 12C18.5 10.8065 18.0259 9.66193 17.182 8.81802C16.3381 7.97411 15.1935 7.5 14 7.5H7.62103L8.56103 8.44C8.83413 8.72303 8.98515 9.10201 8.98155 9.4953C8.97795 9.8886 8.82001 10.2647 8.54177 10.5427C8.26353 10.8207 7.88723 10.9783 7.49393 10.9815C7.10063 10.9847 6.7218 10.8334 6.43903 10.56L2.93903 7.06C2.72941 6.85026 2.58666 6.5831 2.52882 6.29227C2.47097 6.00144 2.50062 5.69999 2.61403 5.426Z" fill="white" />
                        </g>
                        <defs>
                            <clipPath id="clip0_2_333">
                                <rect width="24" height="24" fill="white" />
                            </clipPath>
                        </defs>
                    </svg>
                </button>
            </div>
        </main>
}

